clear;clc;
%--------------------------------------------------------------------------
%   参数设置
%--------------------------------------------------------------------------
N = 8;                                                                      %阵元个数
M = 3;                                                                      %信源个数
theta = [-30 0 50];                                                         %信号来向
snr = 10;                                                                   %信噪比
K = 1024;                                                                   %快拍数

%--------------------------------------------------------------------------
%   生成3个来向的阵列流形信号相位差
%--------------------------------------------------------------------------
lambda = 1;
dd = 0.5;                                                                   %阵元间距d = lambda/2
d = 0:dd:(N-1)*dd;                                                          %构建阵列坐标
A = exp(1j.*2*pi*d.'*sind(theta)/lambda);                                   %构建阵列流形，即信号来向

%--------------------------------------------------------------------------
%   发射三组随机信号，长度1024
%--------------------------------------------------------------------------
S = randn(M,K) + 1j.*randn(M,K);                                            %构建不相关信号
X = A*S;                                                                    %对信号来向进行仿真
X1 = awgn(X,snr,'measured');                                                %加入噪声，产生小特征值

%--------------------------------------------------------------------------
%   构建信号的协方差矩阵
%--------------------------------------------------------------------------
Rxx = X1*X1'/K;                                                             %构建协方差矩阵
[EV,D] = eig(Rxx);                                                          %拿到特向量EV + 特征值D  新版本matlab已经从小到大排序好了
figure(7)
bar3(D);title('特征值矩阵排列')